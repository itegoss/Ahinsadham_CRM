{% extends "base.html" %}
{% block title %}Add Donor / Volunteer{% endblock %}
{% block content %}
<style>
.btn-submit {
    background: linear-gradient(90deg, #1a7a42, #2aa85b);
    color: white;
    box-shadow: 0 4px 12px rgba(32, 129, 70, 0.25);
}
.row {
    margin-left: -12px;
    margin-right: -12px;
}
[class*="col-"] {
    padding-left: 12px;
    padding-right: 12px;
}
@media (min-width: 768px) {
    .col-md-3 {  float: left; }
    .col-md-4 {  float: left; }
    .col-md-6 { width: 50%; float: left; }
}
.row::after {
    content: "";
    display: table;
    clear: both;
}
.form-control,
.form-select {
    width: 100%;
}
#department[style*="display: none"],
#business[style*="display: none"],
#designation[style*="display: none"],
#occupation[style*="display: none"],
#address[style*="display: none"],
#idproof[style*="display: none"],
#donor_box_wrapper[style*="display: none"],
#org[style*="display: none"] {
    display: none !important;
}
</style>
<style>
    .card { background: #f2fff4 !important; border-radius: 12px; }
    .form-control, .form-select { border-radius: 8px; }
    h3.fw-bold { color: #0d7a34; }
    h5.section-title { color: #0d7a34; font-weight: 600; }
    hr { border-top: 2px solid #bae6c6; }
</style>
{% if messages %}
<div class="container mt-3">
    {% for message in messages %}
        <div class="alert alert-danger alert-dismissible fade show text-center">
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
    {% endfor %}
</div>
{% endif %}
<div class="container mt-4 mb-5">
    <div class="card shadow-lg">
        <div class="text-center mb-4 pt-3">
            <h3 class="fw-bold">Add Donor / Volunteer</h3>
            <p class="text-muted">Fill out details to create a donor/volunteer record</p>
        </div>
        <div class="card-body px-4">
            <form method="POST" enctype="multipart/form-data">
                {% csrf_token %}
                <!-- ===================================== PERSON TYPE ===================================== -->
                <h5 class="section-title">Person Type</h5>
                <hr>
                <div class="row g-3 mb-3">
                    <div class="col-md-4">
                        <label class="form-label">Person Type <span style="color: #d9534f;">*</span></label>
                        <select name="person_type" id="person_type" class="form-select" required aria-required="true">
                            <option value="">Select</option>
                            {% for option in person_type_options %}
                                <option value="{{ option.id }}">{{ option.lookup_name }}</option>
                            {% endfor %}
                        </select>
                    </div>
<div class="col-md-4" id="donor_box_wrapper" style="display: none;">
    <label class="form-label">Donor Box</label>
    <select name="donor_box" class="form-select">
        <option value="">Select Donor Box</option>
        {% for box in donation_boxes %}
            <option value="{{ box.id }}">{{ box.donation_id }}</option>
        {% endfor %}
    </select>
</div>
                    <div class="col-md-4" style="margin-top: 1.7%;">
                        <label class="form-label">Referred By</label>
                        <select name="referred_by" id="referred_by" class="form-select select2-search">
                            <option value="">-- Select Person --</option>
                            {% for person in all_donors %}
                                <option value="{{ person.id }}">{{ person.first_name }} {{ person.last_name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
                <!-- ===================================== PERSONAL DETAILS ===================================== -->
                <h5 class="section-title">Personal Details</h5>
                <hr>
<div class="row g-3 mb-4 align-items-end" >
    <div class="col-md-1" style="margin: -1.0%; margin-left: 0">
        <label class="form-label">Sal.</label>
        <select name="salutation" class="form-select">
            <option value="">—</option>
            <option>Mr.</option>
            <option>Mrs.</option>
            <option>Ms.</option>
            <option>Shri</option>
            <option>Smt.</option>
            <option>Kumari</option>
        </select>
    </div>
    <div class="col-md-3">
        <label class="form-label">First Name <span class="text-danger">*</span></label>
        <input type="text" name="first_name" class="form-control" oninput="this.value = this.value.replace(/[^A-Za-z]/g, '')" required>
    </div>
    <div class="col-md-3">
        <label class="form-label">Middle Name</label>
        <input type="text" name="middle_name" class="form-control" oninput="this.value = this.value.replace(/[^A-Za-z]/g, '')">
    </div>
    <div class="col-md-3">
        <label class="form-label">Last Name <span class="text-danger">*</span></label>
        <input type="text" name="last_name" class="form-control" oninput="this.value = this.value.replace(/[^A-Za-z]/g, '')" required>
    </div>
    <div class="col-md-2"></div>
</div>
<div class="row g-3 mb-4">
    <div class="col-md-4">
        <label class="form-label">Gender</label>
        <select name="gender" class="form-select">
            <option value="">Select</option>
            <option>Male</option><option>Female</option><option>Do Not Provide</option>
        </select>
    </div>
    <div class="col-md-4">
        <label class="form-label">Blood Group</label>
        <select name="blood_group" class="form-select text-dark">
            <option value="">Select</option>
            {% for bg, val in blood_groups %}
                <option value="{{ bg }}">{{ bg }}</option>
            {% endfor %}
        </select>
    </div>
</div>
<div class="row g-3 mb-4">
<div class="col-md-3">
  <label class="form-label">Contact Number <span style="color:#d9534f">*</span></label>  
      <div class="input-group">
        <span >  
            <select style="margin-top: 0%;" class="input-group-text" name="contact_country_code" required>
            <option value="+91" selected>+91</option>
            <option value="+1">+1</option>
            <option value="+44">+44</option>
            <option value="+971">+971</option>
            <option value="+61">+61</option>

            <!-- A -->
            <option value="+93">+93</option>
            <option value="+355">+355</option>
            <option value="+213">+213</option>
            <option value="+376">+376</option>
            <option value="+244">+244</option>
            <option value="+54">+54</option>
            <option value="+374">+374</option>
            <option value="+43">+43</option>
            <option value="+994">+994</option>

            <!-- B -->
            <option value="+973">+973</option>
            <option value="+880">+880</option>
            <option value="+375">+375</option>
            <option value="+32">+32</option>
            <option value="+501">+501</option>
            <option value="+229">+229</option>
            <option value="+975">+975</option>
            <option value="+591">+591</option>
            <option value="+387">+387</option>
            <option value="+267">+267</option>
            <option value="+55">+55</option>

            <!-- C -->
            <option value="+855">+855</option>
            <option value="+237">+237</option>
            <option value="+56">+56</option>
            <option value="+86">+86</option>
            <option value="+57">+57</option>
            <option value="+506">+506</option>
            <option value="+385">+385</option>
            <option value="+53">+53</option>
            <option value="+357">+357</option>
            <option value="+420">+420</option>

            <!-- D -->
            <option value="+45">+45</option>
            <option value="+253">+253</option>
            <option value="+213">+213</option>

            <!-- E -->
            <option value="+20">+20</option>
            <option value="+503">+503</option>
            <option value="+372">+372</option>
            <option value="+251">+251</option>

            <!-- F -->
            <option value="+358">+358</option>
            <option value="+33">+33</option>

            <!-- G -->
            <option value="+995">+995</option>
            <option value="+49">+49</option>
            <option value="+233">+233</option>
            <option value="+30">+30</option>

            <!-- H -->
            <option value="+852">+852</option>
            <option value="+36">+36</option>

            <!-- I -->
            <option value="+354">+354</option>
            <option value="+62">+62</option>
            <option value="+98">+98</option>
            <option value="+964">+964</option>
            <option value="+353">+353</option>
            <option value="+972">+972</option>
            <option value="+39">+39</option>

            <!-- J -->
            <option value="+81">+81</option>
            <option value="+962">+962</option>

            <!-- K -->
            <option value="+7">+7</option>
            <option value="+254">+254</option>
            <option value="+965">+965</option>

            <!-- L -->
            <option value="+856">+856</option>
            <option value="+371">+371</option>
            <option value="+961">+961</option>
            <option value="+370">+370</option>
            <option value="+352">+352</option>

            <!-- M -->
            <option value="+60">+60</option>
            <option value="+960">+960</option>
            <option value="+356">+356</option>
            <option value="+52">+52</option>
            <option value="+976">+976</option>

            <!-- N -->
            <option value="+977">+977</option>
            <option value="+31">+31</option>
            <option value="+64">+64</option>
            <option value="+234">+234</option>
            <option value="+47">+47</option>

            <!-- O -->
            <option value="+968">+968</option>

            <!-- P -->
            <option value="+92">+92</option>
            <option value="+63">+63</option>
            <option value="+48">+48</option>
            <option value="+351">+351</option>

            <!-- Q -->
            <option value="+974">+974</option>

            <!-- R -->
            <option value="+40">+40</option>
            <option value="+7">+7</option>

            <!-- S -->
            <option value="+966">+966</option>
            <option value="+65">+65</option>
            <option value="+27">+27</option>
            <option value="+34">+34</option>
            <option value="+94">+94</option>
            <option value="+46">+46</option>
            <option value="+41">+41</option>

            <!-- T -->
            <option value="+886">+886</option>
            <option value="+66">+66</option>
            <option value="+90">+90</option>

            <!-- U -->
            <option value="+380">+380</option>

            <!-- V -->
            <option value="+58">+58</option>
            <option value="+84">+84</option>

            <!-- Y -->
            <option value="+967">+967</option>

            <!-- Z -->
            <option value="+263">+263</option>
        </select></span>
        <input type="text" name="contact_number" class="form-control" placeholder="Enter phone number" maxlength="10" oninput="this.value = this.value.replace(/[^0-9]/g, '')" required>
    </div>
</div>
<div class="col-md-3">
    <label class="form-label">WhatsApp Number</label>
    <div class="input-group">
        <span >  
            <select style="margin-top: 0%;" class="input-group-text" name="contact_country_code" required>
            <option value="+91" selected>+91</option>
            <option value="+1">+1</option>
            <option value="+44">+44</option>
            <option value="+971">+971</option>
            <option value="+61">+61</option>

            <!-- A -->
            <option value="+93">+93</option>
            <option value="+355">+355</option>
            <option value="+213">+213</option>
            <option value="+376">+376</option>
            <option value="+244">+244</option>
            <option value="+54">+54</option>
            <option value="+374">+374</option>
            <option value="+43">+43</option>
            <option value="+994">+994</option>

            <!-- B -->
            <option value="+973">+973</option>
            <option value="+880">+880</option>
            <option value="+375">+375</option>
            <option value="+32">+32</option>
            <option value="+501">+501</option>
            <option value="+229">+229</option>
            <option value="+975">+975</option>
            <option value="+591">+591</option>
            <option value="+387">+387</option>
            <option value="+267">+267</option>
            <option value="+55">+55</option>

            <!-- C -->
            <option value="+855">+855</option>
            <option value="+237">+237</option>
            <option value="+56">+56</option>
            <option value="+86">+86</option>
            <option value="+57">+57</option>
            <option value="+506">+506</option>
            <option value="+385">+385</option>
            <option value="+53">+53</option>
            <option value="+357">+357</option>
            <option value="+420">+420</option>

            <!-- D -->
            <option value="+45">+45</option>
            <option value="+253">+253</option>
            <option value="+213">+213</option>

            <!-- E -->
            <option value="+20">+20</option>
            <option value="+503">+503</option>
            <option value="+372">+372</option>
            <option value="+251">+251</option>

            <!-- F -->
            <option value="+358">+358</option>
            <option value="+33">+33</option>

            <!-- G -->
            <option value="+995">+995</option>
            <option value="+49">+49</option>
            <option value="+233">+233</option>
            <option value="+30">+30</option>

            <!-- H -->
            <option value="+852">+852</option>
            <option value="+36">+36</option>

            <!-- I -->
            <option value="+354">+354</option>
            <option value="+62">+62</option>
            <option value="+98">+98</option>
            <option value="+964">+964</option>
            <option value="+353">+353</option>
            <option value="+972">+972</option>
            <option value="+39">+39</option>

            <!-- J -->
            <option value="+81">+81</option>
            <option value="+962">+962</option>

            <!-- K -->
            <option value="+7">+7</option>
            <option value="+254">+254</option>
            <option value="+965">+965</option>

            <!-- L -->
            <option value="+856">+856</option>
            <option value="+371">+371</option>
            <option value="+961">+961</option>
            <option value="+370">+370</option>
            <option value="+352">+352</option>

            <!-- M -->
            <option value="+60">+60</option>
            <option value="+960">+960</option>
            <option value="+356">+356</option>
            <option value="+52">+52</option>
            <option value="+976">+976</option>

            <!-- N -->
            <option value="+977">+977</option>
            <option value="+31">+31</option>
            <option value="+64">+64</option>
            <option value="+234">+234</option>
            <option value="+47">+47</option>

            <!-- O -->
            <option value="+968">+968</option>

            <!-- P -->
            <option value="+92">+92</option>
            <option value="+63">+63</option>
            <option value="+48">+48</option>
            <option value="+351">+351</option>

            <!-- Q -->
            <option value="+974">+974</option>

            <!-- R -->
            <option value="+40">+40</option>
            <option value="+7">+7</option>

            <!-- S -->
            <option value="+966">+966</option>
            <option value="+65">+65</option>
            <option value="+27">+27</option>
            <option value="+34">+34</option>
            <option value="+94">+94</option>
            <option value="+46">+46</option>
            <option value="+41">+41</option>

            <!-- T -->
            <option value="+886">+886</option>
            <option value="+66">+66</option>
            <option value="+90">+90</option>

            <!-- U -->
            <option value="+380">+380</option>

            <!-- V -->
            <option value="+58">+58</option>
            <option value="+84">+84</option>

            <!-- Y -->
            <option value="+967">+967</option>

            <!-- Z -->
            <option value="+263">+263</option>
        </select></span>
        <input type="text" name="whatsapp_number" class="form-control" maxlength="10" pattern="[0-9]{10}" placeholder="Enter whatsapp number" oninput="this.value = this.value.replace(/[^0-9]/g, '')">
    </div>
</div>
    <div class="col-md-4">
        <label class="form-label">Email </label>
        <input type="email" name="email" class="form-control">
    </div>
</div>
<div class="row g-3 mb-4" id="doa">
    <div class="col-md-3">
        <label class="form-label">Date of Anniversary</label>
        <input type="date" name="doa" id="doa_input" class="form-control">
    </div>

    <div class="col-md-3">
        <label class="form-label">Years to Marriage</label>
        <input type="number" name="years_to_marriage" id="years_to_marriage" class="form-control" readonly>
    </div>
    <div class="col-md-3">
        <label class="form-label">Date of Birth <span style="color: #d9534f;">*</span></label>
        <input type="date" name="date_of_birth" id="date_of_birth" class="form-control" required aria-required="true">
    </div>

    <div class="col-md-3">
        <label class="form-label">Age</label>
        <input type="number" name="age" id="age" class="form-control" readonly>
    </div>
</div>
                <!-- ===================================== ADDRESS DETAILS ===================================== -->
                <h5 class="section-title">Address Details</h5>
                <hr>
                <div class="row g-3 mb-4" id="address">
                    <div class="col-md-4">
                        <label class="form-label">House Number <span style="color: #d9534f;">*</span></label>
                        <input type="text" name="house_number" class="form-control" required aria-required="true">
                    </div>
                    <div class="col-md-4">
                        <label class="form-label">Building Name <span style="color: #d9534f;">*</span></label>
                        <input type="text" name="building_name" class="form-control" required aria-required="true">
                    </div>
                    <div class="col-md-4">
                        <label class="form-label">Landmark <span style="color: #d9534f;">*</span></label>
                        <input type="text" name="landmark" class="form-control" required aria-required="true">
                    </div>
                    <div class="col-md-4">
                        <label class="form-label">Area <span style="color: #d9534f;">*</span></label>
                        <input type="text" name="area" class="form-control" required aria-required="true">
                    </div>
                    <div class="col-md-4">
                        <label class="form-label">City <span style="color: #d9534f;">*</span></label>
                        <input type="text" name="city" class="form-control" required aria-required="true">
                    </div>
                    <!-- <div class="col-md-4">
                        <label class="form-label">State <span style="color: #d9534f;">*</span></label>
                        <input type="text" name="state" class="form-control" required aria-required="true">
                    </div>
                 <div class="col-md-4">
    <label class="form-label">
        Country <span style="color:#d9534f">*</span>
    </label>

    <select name="country" class="form-select" required>
        <option value="India" selected>India</option>
        <option value="Afghanistan">Afghanistan</option>
        <option value="Albania">Albania</option>
        <option value="Algeria">Algeria</option>
        <option value="Andorra">Andorra</option>
        <option value="Angola">Angola</option>
        <option value="Argentina">Argentina</option>
        <option value="Armenia">Armenia</option>
        <option value="Australia">Australia</option>
        <option value="Austria">Austria</option>
        <option value="Azerbaijan">Azerbaijan</option>
        <option value="Bahamas">Bahamas</option>
        <option value="Bahrain">Bahrain</option>
        <option value="Bangladesh">Bangladesh</option>
        <option value="Belgium">Belgium</option>
        <option value="Belize">Belize</option>
        <option value="Bhutan">Bhutan</option>
        <option value="Bolivia">Bolivia</option>
        <option value="Brazil">Brazil</option>
        <option value="Cambodia">Cambodia</option>
        <option value="Canada">Canada</option>
        <option value="China">China</option>
        <option value="Colombia">Colombia</option>
        <option value="Croatia">Croatia</option>
        <option value="Denmark">Denmark</option>
        <option value="Egypt">Egypt</option>
        <option value="France">France</option>
        <option value="Germany">Germany</option>
        <option value="Greece">Greece</option>
        <option value="Hong Kong">Hong Kong</option>
        <option value="Hungary">Hungary</option>
        <option value="Indonesia">Indonesia</option>
        <option value="Iran">Iran</option>
        <option value="Ireland">Ireland</option>
        <option value="Israel">Israel</option>
        <option value="Italy">Italy</option>
        <option value="Japan">Japan</option>
        <option value="Kenya">Kenya</option>
        <option value="Kuwait">Kuwait</option>
        <option value="Malaysia">Malaysia</option>
        <option value="Maldives">Maldives</option>
        <option value="Mexico">Mexico</option>
        <option value="Nepal">Nepal</option>
        <option value="Netherlands">Netherlands</option>
        <option value="New Zealand">New Zealand</option>
        <option value="Nigeria">Nigeria</option>
        <option value="Pakistan">Pakistan</option>
        <option value="Philippines">Philippines</option>
        <option value="Poland">Poland</option>
        <option value="Portugal">Portugal</option>
        <option value="Qatar">Qatar</option>
        <option value="Romania">Romania</option>
        <option value="Russia">Russia</option>
        <option value="Saudi Arabia">Saudi Arabia</option>
        <option value="Singapore">Singapore</option>
        <option value="South Africa">South Africa</option>
        <option value="Spain">Spain</option>
        <option value="Sri Lanka">Sri Lanka</option>
        <option value="Sweden">Sweden</option>
        <option value="Switzerland">Switzerland</option>
        <option value="Thailand">Thailand</option>
        <option value="Turkey">Turkey</option>
        <option value="United Arab Emirates">United Arab Emirates</option>
        <option value="United Kingdom">United Kingdom</option>
        <option value="United States">United States</option>
        <option value="Vietnam">Vietnam</option>
        <option value="Zimbabwe">Zimbabwe</option>
    </select>
</div> -->






<div class="col-md-4">
    <label class="form-label">Country</label>
    <select id="country" name="country" class="form-select">
        <option value="">Select</option>
 <option value="India">India</option>

        <!-- A -->
        <option value="Afghanistan">Afghanistan</option>
        <option value="Albania">Albania</option>
        <option value="Algeria">Algeria</option>
        <option value="Andorra">Andorra</option>
        <option value="Angola">Angola</option>
        <option value="Argentina">Argentina</option>
        <option value="Armenia">Armenia</option>
        <option value="Australia">Australia</option>
        <option value="Austria">Austria</option>
        <option value="Azerbaijan">Azerbaijan</option>

        <!-- B -->
        <option value="Bahamas">Bahamas</option>
        <option value="Bahrain">Bahrain</option>
        <option value="Bangladesh">Bangladesh</option>
        <option value="Belgium">Belgium</option>
        <option value="Belize">Belize</option>
        <option value="Bhutan">Bhutan</option>
        <option value="Bolivia">Bolivia</option>
        <option value="Brazil">Brazil</option>

        <!-- C -->
        <option value="Cambodia">Cambodia</option>
        <option value="Canada">Canada</option>
        <option value="China">China</option>
        <option value="Colombia">Colombia</option>
        <option value="Croatia">Croatia</option>

        <!-- D -->
        <option value="Denmark">Denmark</option>

        <!-- E -->
        <option value="Egypt">Egypt</option>

        <!-- F -->
        <option value="France">France</option>

        <!-- G -->
        <option value="Germany">Germany</option>
        <option value="Greece">Greece</option>

        <!-- H -->
        <option value="Hong Kong">Hong Kong</option>
        <option value="Hungary">Hungary</option>

        <!-- I -->
        <option value="Indonesia">Indonesia</option>
        <option value="Iran">Iran</option>
        <option value="Ireland">Ireland</option>
        <option value="Israel">Israel</option>
        <option value="Italy">Italy</option>

        <!-- J -->
        <option value="Japan">Japan</option>

        <!-- K -->
        <option value="Kenya">Kenya</option>
        <option value="Kuwait">Kuwait</option>

        <!-- M -->
        <option value="Malaysia">Malaysia</option>
        <option value="Maldives">Maldives</option>
        <option value="Mexico">Mexico</option>

        <!-- N -->
        <option value="Nepal">Nepal</option>
        <option value="Netherlands">Netherlands</option>
        <option value="New Zealand">New Zealand</option>
        <option value="Nigeria">Nigeria</option>

        <!-- P -->
        <option value="Pakistan">Pakistan</option>
        <option value="Philippines">Philippines</option>
        <option value="Poland">Poland</option>
        <option value="Portugal">Portugal</option>

        <!-- Q -->
        <option value="Qatar">Qatar</option>

        <!-- R -->
        <option value="Romania">Romania</option>
        <option value="Russia">Russia</option>

        <!-- S -->
        <option value="Saudi Arabia">Saudi Arabia</option>
        <option value="Singapore">Singapore</option>
        <option value="South Africa">South Africa</option>
        <option value="Spain">Spain</option>
        <option value="Sri Lanka">Sri Lanka</option>
        <option value="Sweden">Sweden</option>
        <option value="Switzerland">Switzerland</option>

        <!-- T -->
        <option value="Thailand">Thailand</option>
        <option value="Turkey">Turkey</option>

        <!-- U -->
        <option value="United Arab Emirates">United Arab Emirates</option>
        <option value="United Kingdom">United Kingdom</option>
        <option value="United States">United States</option>

        <!-- V -->
        <option value="Vietnam">Vietnam</option>

        <!-- Z -->
        <option value="Zimbabwe">Zimbabwe</option>
    </select>
</div>

<div class="col-md-4" id="stateDropdownBox">
    <label class="form-label">State</label>
    <select id="state" name="state" class="form-select">
    </select>
</div>

<div class="col-md-4" id="stateTextboxBox" style="display: none;">
    <label class="form-label">State</label>
    <input type="text" id="state_text" name="state_text" class="form-control" placeholder="Enter State">
</div>

                    <div class="col-md-4">
                        <label class="form-label">Postal Code <span style="color: #d9534f;">*</span></label>
                        <input type="text" name="postal_code" class="form-control" oninput="this.value = this.value.replace(/[^0-9]/g, '')" required aria-required="true">
                    </div>

                    <div class="col-md-4">
                        <label class="form-label">Native Place</label>
                        <input type="text" name="native_place" class="form-control">
                    </div>

                    <!-- <div class="col-md-4">
                        <label class="form-label">Native Postal Code</label>
                        <input type="text" name="native_postal_code" class="form-control" oninput="this.value = this.value.replace(/[^0-9]/g, '')">
                    </div> -->
                </div>
                <hr>
                <div class="row g-3 mb-4" id="designation">
                    <div class="col-md-4">
                        <label class="form-label">Designation</label>
                        <select name="designation" class="form-select">
                            <option value="">Select</option>
                            {% for item in designations %}
                                <option value="{{ item.id }}">{{ item.lookup_name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
                <hr>
                <!-- ===================================== OCCUPATION ===================================== -->
                <div class="row g-3 mb-4" id="occupation">
                                    <h5 class="section-title">Occupation Details</h5>
                <hr>
                    <div class="col-md-4">
                        <label class="form-label">Occupation Type</label>
                        <select name="occupation_type" class="form-select">
                            <option value="">Select</option>
                            {% for item in occupation_types %}
                                <option value="{{ item.id }}">{{ item.lookup_name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="col-md-4">
                        <label class="form-label">Occupation Nature</label>
                        <select name="occupation_nature" class="form-select">
                            <option value="">Select</option>
                            {% for item in occupation_natures %}
                                <option value="{{ item.id }}">{{ item.lookup_name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
                <!-- ===================================== DEPARTMENT ===================================== -->
                <div class="row g-3 mb-4" id="department">
                                    <h5 class="section-title">Department Details</h5>
                <hr>
                    <div class="col-md-4">
                        <label class="form-label">Department</label>
                        <select name="department" class="form-select">
                            <option value="">Select</option>
                            {% for item in departments %}
                                <option value="{{ item.id }}">{{ item.lookup_name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="col-md-4">
                        <label class="form-label">Position</label>
                        <select name="position" class="form-select">
                            <option value="">Select</option>
                            {% for item in positions %}
                                <option value="{{ item.id }}">{{ item.lookup_name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>

                <!-- ===================================== BUSINESS ===================================== -->

<!-- Business Section -->
<div id="business" style="display: none;">
    <h5 class="section-title">Business Details / Organization Details</h5>
    <hr>
    <div class="row g-3 mb-4 align-items-end">
        
        <div class="col-md-2">
            <label class="form-label">Business/Org Salutation</label>
            <select name="business_salutation" class="form-select">
                <option value="">-- Select --</option>
                <option value="Mr.">Mr.</option>
                <option value="Mrs.">Mrs.</option>
                <option value="Ms.">Ms.</option>
                <option value="Dr.">Dr.</option>
                <option value="Prof.">Prof.</option>
                <option value="CEO">CEO</option>
                <option value="Director">Director</option>
            </select>
        </div>

        <div class="col-md-3" style="margin-bottom: 1.0%;">
            <label class="form-label">Business Name</label>
            <input type="text" name="business_name" class="form-control">
        </div>

        <div class="col-md-3">
            <label class="form-label">Business Type</label>
            <select name="business_type" class="form-select">
                <option value="">Select</option>
                {% for item in business_types %}
                    <option value="{{ item.id }}">{{ item.lookup_name }}</option>
                {% endfor %}
            </select>
        </div>

        <div class="col-md-4" style="margin-bottom: 1.0%;">
            <label class="form-label">Business Nature</label>
            <input type="text" name="business_nature" class="form-control" placeholder="Enter business nature">
        </div>
    </div>
</div>
                <!-- <div class="row g-3 mb-4 align-items-end" id="business" style="display: none;">
                                    <h5 class="section-title">Business Details/Organization Details</h5>
                <hr>
                    <div class="col-md-1">
                    <label class="form-label">Business/Org Salutation</label>
                        <select name="business_salutation" class="form-select">
                            <option value="">-- Select Salutation --</option>
                            <option value="Mr.">Mr.</option>
                            <option value="Mrs.">Mrs.</option>
                            <option value="Ms.">Ms.</option>
                            <option value="Dr.">Dr.</option>
                            <option value="Prof.">Prof.</option>
                            <option value="CEO">CEO</option>
                            <option value="Director">Director</option>
                        </select>
                    </div>
                    <div class="col-md-3">
                        <label class="form-label">Business Name</label>
                        <input type="text" name="business_name" class="form-control">
                    </div>

                    <div class="col-md-3" style="margin-top: 0.6%;">
                        <label class="form-label">Business Type</label>
                        <select name="business_type" class="form-select">
                            <option value="">Select</option>
                            {% for item in business_types %}
                                <option value="{{ item.id }}">{{ item.lookup_name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="col-md-3">
                        <label class="form-label">Business Nature</label>
                        <input type="text" name="business_nature" class="form-control" placeholder="Enter business nature">
                    </div>
                </div> -->

                <!-- ===================================== ORGANIZATION ===================================== -->
                <hr>
                <div class="row g-3 mb-4" id="org">
                    <div class="col-md-4">
                        <label class="form-label">Organization Name</label>
                        <input type="text" name="org_name" class="form-control">
                    </div>
                    <div class="col-md-4">
                        <label class="form-label">Organization Type</label>
                        <select name="org_type" class="form-select">
                            <option value="">Select</option>
                            {% for item in org_types %}
                                <option value="{{ item.id }}">{{ item.lookup_name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="col-md-4">
                        <label class="form-label">Nature of Service</label>
                        <input type="text" name="nature_of_service" class="form-control">
                    </div>
                </div>
                <!-- ===================================== ID & PAN ===================================== -->
                <h5 class="section-title">ID & PAN Details</h5>
                <hr>
<div class="row g-3 mb-3" id="idproof">
    <div class="col-md-4">
        <label class="form-label">ID Type <span style="color: #d9534f;">*</span></label>
        <select name="id_type" class="form-select" required aria-required="true">
            <option value="">Select</option>
            {% for item in id_type_options %}
                <option value="{{ item.id }}">{{ item.lookup_name }}</option>
            {% endfor %}
        </select>
    </div>
</div>
<div class="row g-3 mb-3">
    <div class="col-md-4">
        <label class="form-label">ID Number <span style="color: #d9534f;">*</span></label>
        <input type="text" name="id_number" class="form-control" required aria-required="true">
    </div>
    <div class="col-md-4">
        <label class="form-label">Upload ID Proof </label>
        <input type="file" name="id_proof_image" class="form-control">
    </div>
</div>
<div class="row g-3 mb-4">
    <div class="col-md-4">
        <label class="form-label">PAN Number <span style="color: #d9534f;">*</span></label>
        <input type="text" name="pan_number" class="form-control" required aria-required="true">
    </div>

    <div class="col-md-4">
        <label class="form-label">Upload PAN Card </label>
        <input type="file" name="pan_card_image" class="form-control">
    </div>
</div>
                <div class="action-buttons">
        <button type="submit" class="action-btn btn btn-submit">✔ Save</button>
        <a href="/welcome/?tab=Donation Module" class="action-btn back-btn">← Back</a>
    </div>
            </form>
        </div>
    </div>
</div>
<script>
const indiaStates = [
  "Andhra Pradesh",
  "Arunachal Pradesh",
  "Assam",
  "Bihar",
  "Chhattisgarh",
  "Goa",
  "Gujarat",
  "Haryana",
  "Himachal Pradesh",
  "Jharkhand",
  "Karnataka",
  "Kerala",
  "Madhya Pradesh",
  "Maharashtra",
  "Manipur",
  "Meghalaya",
  "Mizoram",
  "Nagaland",
  "Odisha",
  "Punjab",
  "Rajasthan",
  "Sikkim",
  "Tamil Nadu",
  "Telangana",
  "Tripura",
  "Uttar Pradesh",
  "Uttarakhand",
  "West Bengal"
];


document.getElementById('country').addEventListener('change', function() {
    const country = this.value;
    const dropdownBox = document.getElementById('stateDropdownBox');
    const textboxBox = document.getElementById('stateTextboxBox');
    const stateSelect = document.getElementById('state');

    if (country === "India") {
        // Show dropdown
        dropdownBox.style.display = "block";
        textboxBox.style.display = "none";

        // Load India states
        stateSelect.innerHTML = "";
        indiaStates.forEach(function(state) {
            let opt = document.createElement("option");
            opt.value = state;
            opt.text = state;
            stateSelect.appendChild(opt);
        });

    } else {
        // Show Text box
        dropdownBox.style.display = "none";
        textboxBox.style.display = "block";
    }
});
</script>










<script>
document.addEventListener("DOMContentLoaded", function () {
    const personType = document.getElementById("person_type");
    const baseSections = [
        "persontype",
        "personaldetails",
        "idproof",
        "address",
        "occupation",
        "designation"
    ];

    // Conditional sections
    const department = document.getElementById("department");
    const position = document.getElementById("position");
    const business = document.getElementById("business");
    const donorBox = document.getElementById("donor_box_wrapper");
    const org = document.getElementById("org");
    const employee = document.getElementById("employee");


    function normalize(text) {
        return text.toLowerCase().replace(/[\s\-_]/g, "");
    }

    function hideAllConditional() {
        if (department) department.style.display = "none";
        if (position) position.style.display = "none";
        if (business) business.style.display = "none";
        if (donorBox) donorBox.style.display = "none";
        if (org) org.style.display = "none";
        if (occupation) occupation.style.display = "block";

    }

    function showBaseSections() {
        baseSections.forEach(id => {
            const el = document.getElementById(id);
            if (el) el.style.display = "block";
        });
    }

    function updateVisibility() {
        const selectedOption = personType.options[personType.selectedIndex];
        const text = selectedOption ? normalize(selectedOption.text) : "";
        showBaseSections();
        hideAllConditional();
        if (!text) return;

        if (text === "employee") {
            if (department) department.style.display = "block";
            if (occupation) occupation.style.display = "none";

        }
        else if (text === "committeemember") {
            if (position) position.style.display = "block";
        }
        else if (text === "business") {
            if (business) business.style.display = "block";
        }
        else if (text === "organization") {
            if (org) org.style.display = "block";
        }
        else if (text === "donationboxowner" || text === "donorboxowner") {
            // ✅ THIS IS WHAT YOU WANT
            if (business) business.style.display = "block";
            if (donorBox) donorBox.style.display = "block";
            if (occupation) occupation.style.display = "none";
        }
    }
    updateVisibility();
    personType.addEventListener("change", updateVisibility);
});
</script>

<!-- ================= AGE AUTO CALCULATION ================= -->
 
<script>
document.getElementById("date_of_birth").addEventListener("change", function () {
    let dob = new Date(this.value);
    if (!isNaN(dob)) {
        let diff = Date.now() - dob.getTime();
        let age = new Date(diff).getUTCFullYear() - 1970;
        document.getElementById("age").value = age;
    }
});
</script>

<!-- ================= YEARS TO MARRIAGE AUTO CALCULATION ================= -->
<script>
document.addEventListener("DOMContentLoaded", function () {

    const doaInput = document.getElementById("doa_input");
    const yearsField = document.getElementById("years_to_marriage");

    doaInput.addEventListener("change", function () {

        if (!this.value) {
            yearsField.value = "";
            return;
        }

        const doa = new Date(this.value);
        const today = new Date();

        let years = today.getFullYear() - doa.getFullYear();

        // Adjust if anniversary hasn't occurred yet this year
        const hasHadAnniversaryThisYear =
            today.getMonth() > doa.getMonth() ||
            (today.getMonth() === doa.getMonth() && today.getDate() >= doa.getDate());

        if (!hasHadAnniversaryThisYear) {
            years--;
        }

        yearsField.value = years >= 0 ? years : 0;
    });

});
</script>
<!-- ================= SHOW DONOR BOX FOR DONOR-BOX-OWNER ================= -->
<script>
$(document).ready(function () {
    $('#referred_by').select2({
        placeholder: "-- Select or Type Person --",
        allowClear: true,
        tags: true,                 // ✅ ALLOWS TYPING
        width: '100%'
    });
});
</script>


<!-- <script>
document.addEventListener("DOMContentLoaded", function () {

    const personType = document.getElementById("person_type");
    const baseSections = [
        "persontype",
        "personaldetails",
        "idproof",
        "address",
        "occupation",
        "designation"
    ];

    const department = document.getElementById("department");
    const position = document.getElementById("position") || document.getElementById("department");
    const business = document.getElementById("business");
    const donorBox = document.getElementById("donor_box_wrapper");
    const org = document.getElementById("org");

    function hideAllConditional() {
        if (department) department.style.display = "none";
        if (position) position.style.display = "none";
        if (business) business.style.display = "none";
        if (donorBox) donorBox.style.display = "none";
        if (org) org.style.display = "none"; 
    }

    function showBaseSections() {
        baseSections.forEach(id => {
            const el = document.getElementById(id);
            if (el) el.style.display = "block";
        });
    }

    function updateVisibility() {
        const selectedText = personType.options[personType.selectedIndex]?.text.trim();

        showBaseSections();

        hideAllConditional();

        if (!selectedText) return;

        if (selectedText === "Employee") {
            if (department) department.style.display = "block";
        }
        else if (selectedText === "Committee Member") {
            if (position) position.style.display = "block";
        }
        else if (selectedText === "Business") {
            if (business) business.style.display = "block";
        }
        else if (selectedText === "Organization") {
            if (org) org.style.display = "block";  
        }
        else if (selectedText === "Donation-Box-Owner") {
            if (business) business.style.display = "block";
            if (donorBox) donorBox.style.display = "block";
        }
    }

    updateVisibility();

    personType.addEventListener("change", updateVisibility);

});
</script> -->
<script>
document.addEventListener("DOMContentLoaded", function () {

    const personType = document.getElementById("person_type");
    const businessSal = document.getElementById("business-sal");

    function updateBusinessSalutation() {
        const selectedText =
            personType.options[personType.selectedIndex]?.text.trim();

        // Hide by default
        businessSal.style.display = "none";
        if (selectedText === "Business" || selectedText === "Organization") {
            businessSal.style.display = "block";
        }
    }

    // Init on load
    updateBusinessSalutation();

    // On change
    personType.addEventListener("change", updateBusinessSalutation);

});
</script>


{% endblock %}
