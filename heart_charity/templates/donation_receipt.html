<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Donation Receipt</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <style>
  /* üåø Global Styles */
  body {
    font-family: "Poppins", Arial, sans-serif;
    background: #e9f7ee; /* light green background */
    margin: 0;
    padding: 0;
  }

  h2 {
    text-align: center;
    color: #1e5631; /* dark green */
    margin-bottom: 20px;
  }

  /* üßæ Receipt Card */
  .receipt-container {
    background: #ffffff;
    border-radius: 14px;
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
    padding: 25px 35px;
    margin: 40px auto;
    max-width: 650px;
    
    /* Top border dark green */
    border-top: 5px solid #1e5631;  
    transition: transform 0.2s;
  }

  .receipt-container:hover {
    transform: translateY(-4px);
  }

  .receipt-container p {
    font-size: 15px;
    color: #2e5031; /* medium-dark green text */
    margin: 6px 0;
    line-height: 1.6;
  }

  .receipt-container strong {
    color: #1b4332; /* deep dark green */
  }

  /* üéÄ Header Area */
  .header-section {
    text-align: center;
    margin-bottom: 20px;
  }

  .header-section h1 {
    color: #1e5631; /* dark green heading */
    font-size: 24px;
    margin-bottom: 5px;
  }

  .header-section small {
    color: #71a781; /* soft green-gray */
  }

  /* üîò Buttons */
  .button-bar {
    text-align: center;
    margin-top: 25px;
  }

  .btn {
    display: inline-block;
    padding: 10px 18px;
    margin: 6px;
    border-radius: 6px;
    text-decoration: none;
    font-weight: 500;
    border: none;
    cursor: pointer;
    transition: all 0.3s ease;
  }

  /* Dark Green */
  .btn-primary { 
    background: #1e5631; /* dark green */
    color: #fff;
  }
  .btn-primary:hover { 
    background: #163f23; /* darker green on hover */
  }

  /* Medium Green */
  .btn-secondary { 
    background: #4caf50; /* medium fresh green */
    color: #fff;
  }
  .btn-secondary:hover { 
    background: #3b8e41; 
  }

  /* Light Green Button */
  .btn-light { 
    background: #c8e6c9; /* very light green */
    color: #1e5631;
    border: 1px solid #a5d6a7;
  }
  .btn-light:hover {
    background: #b4dcb8; 
  }

  /* üì± Responsive Design */
  @media (max-width: 700px) {
    .receipt-container {
      margin: 20px;
      padding: 20px;
    }
    h2 {
      font-size: 20px;
    }
    .btn {
      padding: 8px 14px;
      font-size: 14px;
    }
  }
</style>
</head>

<body>
  <div class="header-section">
    <h1>Ahinsadham</h1>
    <small>Registered NGO | Thank you for your generous donation ‚ù§Ô∏è</small>
  </div>

  <div id="receipt">
    {% for donation in donations %}
      <div class="receipt-container">
        <h2>Donation Receipt</h2>
        <p><strong>Receipt ID:</strong> {{ donation.receipt_id }}</p>
        <p><strong>Donor:</strong> {{ donation.donor.first_name }} {{ donation.donor.last_name }}</p>
        <p><strong>Amount:</strong> ‚Çπ{{ donation.donation_amount }}</p>
        <p><strong>Date:</strong> {{ donation.donation_date }}</p>
        <p><strong>Category:</strong> {{ donation.donation_category }}</p>
        <p><strong>Donation Mode:</strong> {{ donation.donation_mode }}</p>
        <p><strong>Payment Method:</strong> {{ donation.payment_method }}</p>
        <p><strong>Transaction ID:</strong> {{ donation.transaction_id|default:"-" }}</p>
        <p><strong>Payment Status:</strong> {{ donation.payment_status }}</p>
      </div>
    {% empty %}
      <p style="text-align:center; color:#777;">No donations found.</p>
    {% endfor %}
  </div>

  <div class="button-bar">
    <button class="btn btn-primary" onclick="downloadPDF()">Download PDF</button>
    <button class="btn btn-secondary" onclick="shareReceipt()">Share Receipt</button>
    <a href="/welcome/" class="btn btn-light">‚Üê Back</a>
  </div>

  <script>
    // üßæ Function to download the receipt as PDF
    function downloadPDF() {
      const element = document.getElementById('receipt');
      const opt = {
        margin: 0.5,
        filename: 'donation_receipt.pdf',
        image: { type: 'jpeg', quality: 0.98 },
        html2canvas: { scale: 2 },
        jsPDF: { unit: 'in', format: 'a4', orientation: 'portrait' }
      };
      html2pdf().set(opt).from(element).save();
    }

    // üîó Share or copy link
    function shareReceipt() {
      const shareUrl = window.location.href;
      const shareText = `Here‚Äôs my donation receipt from Ahinsadham: ${shareUrl}`;
      if (navigator.share) {
        navigator.share({
          title: 'My Donation Receipt',
          text: shareText,
          url: shareUrl
        }).catch(err => console.log('Share cancelled or failed:', err));
      } else {
        navigator.clipboard.writeText(shareUrl).then(() => {
          alert('Link copied to clipboard!');
        }).catch(err => {
          console.error('Failed to copy:', err);
        });
      }
    }
  </script>
</body>
</html>
