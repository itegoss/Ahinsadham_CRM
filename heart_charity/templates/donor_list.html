<div class="table-responsive scrollable-table">
  <form method="POST" action="{% url 'assign_role' %}">
    {% csrf_token %}
    <table class="table table-hover table-bordered align-middle paginated-table">
      <thead class="table-primary sticky-top">
        <tr>
          <th>Actions</th>
          <th>Select Role</th>
          <th>ID</th>
          <th>Username</th>
          <th>First Name</th>
          <th>Last Name</th>
          <th>Email</th>
          <th>Is Staff</th>
          <th>Is Active</th>
          <th>Is Superuser</th>
          <th>Last Login</th>
          <th>Date</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            <a href="/access_control/" class="btn btn-sm p-1"><i class="bi bi-shield-lock"></i></a>
            <a href="/access_control/" class="btn btn-sm p-1">‚¨áÔ∏è</a>
          </td>
          {% for i in "12345678901"|make_list %}
          <td>
            <div class="download-group">
              <input type="text" id="search" name="search" placeholder="Search...">
            </div>
          </td>
          {% endfor %}
        </tr>

        {% for user in showall %}
        <tr>
          <td>
            <div class="d-inline-flex align-items-center gap-1">
              <!-- üìù Edit -->
              <a href="{% url 'edit_user' user.id %}" class="btn btn-sm p-1">
                <i class="bi bi-pencil-square"></i>
              </a>

              <!-- üóëÔ∏è Delete -->
              <form method="POST" action="{% url 'delete_user' user.id %}" class="d-inline m-0 p-0">
                {% csrf_token %}
                <button type="submit" class="btn btn-sm p-1"
                  onclick="return confirm('Are you sure you want to deactivate this user?')">
                  <i class="bi bi-trash"></i>
                </button>
              </form>

              <!-- üîê Access -->
              <a href="{% url 'access_control' %}" class="btn btn-sm p-1">
                <i class="bi bi-shield-lock"></i>
              </a>
            </div>
          </td>

          <td>
            <form method="POST" action="{% url 'assign_role' %}">
              {% csrf_token %}
              <input type="hidden" name="user_id" value="{{ user.id }}">
              <div class="d-flex align-items-center gap-2">
                <select name="role_id" class="form-select w-auto">
                  <option value="">Select Role</option>
                  {% for role in roles %}
                  <option value="{{ role.id }}"
                    {% if user.userrole and user.userrole.role and user.userrole.role.id == role.id %}selected{% endif %}>
                    {{ role.role }}
                  </option>
                  {% endfor %}
                </select>
                <a href="#">üíæ</a>
              </div>
            </form>
          </td>

          <td>{{ user.id }}</td>
          <td>{{ user.username }}</td>
          <td>{{ user.first_name }}</td>
          <td>{{ user.last_name }}</td>
          <td>{{ user.email }}</td>
          <td>{{ user.is_staff }}</td>
          <td>
            {% if user.is_active %}
              <span class="badge1">Active</span>
            {% else %}
              <span class="badge1">Inactive</span>
            {% endif %}
          </td>
          <td>{{ user.is_superuser }}</td>
          <td>{{ user.last_login }}</td>
          <td>{{ user.date_joined }}</td>
        </tr>
        {% empty %}
        <tr><td colspan="12">No users found.</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </form>

  <!-- ‚úÖ Pagination -->
  <div class="d-flex justify-content-center align-items-center mt-3 flex-wrap">
    {% if page_obj.has_previous %}
      <a href="?page=1" class="btn btn-outline-primary btn-sm me-2">‚èÆ First</a>
      <a href="?page={{ page_obj.previous_page_number }}" class="btn btn-outline-primary btn-sm me-2">‚óÄ Prev</a>
    {% endif %}

    <span class="fw-bold mb-2">Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</span>

    {% if page_obj.has_next %}
      <a href="?page={{ page_obj.next_page_number }}" class="btn btn-outline-primary btn-sm ms-2">Next ‚ñ∂</a>
      <a href="?page={{ page_obj.paginator.num_pages }}" class="btn btn-outline-primary btn-sm ms-2">Last ‚è≠</a>
    {% endif %}
  </div>
</div>

<!-- ‚úÖ Scroll CSS -->
<style>
.scrollable-table {
  max-height: 450px; /* Vertical scroll */
  overflow-y: auto;
  overflow-x: auto; /* Horizontal scroll */
}
table th, table td {
  white-space: nowrap; /* Prevent wrapping */
}
.table thead th {
  position: sticky;
  top: 0;
  background-color: #e9f2ff;
  z-index: 5;
}
</style>
